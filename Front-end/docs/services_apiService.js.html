<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: services/apiService.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: services/apiService.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { useState, useEffect } from "react";
import axios from "axios";

/**
 * Custom Hook creation for requests BackEnd Datas
 * @param { Function } path Path getting by User Id
 * @returns {(Objects | data)} data, isLoading, error
 */

export function useRequestDatas (path){
    // 3 variables d'etat (données, chargement, erreurs)
    const [data, setData] = useState({});
    const [isLoading, setIsLoading] = useState(false);
    const [error, setError] = useState(false);

    useEffect(() => {
        // Definition des endPoints fournit par le BackEnd
        const endPoints = [`http://localhost:3000/user/${path}`, 
                           `http://localhost:3000/user/${path}/activity`,
                           `http://localhost:3000/user/${path}/average-sessions`, 
                           `http://localhost:3000/user/${path}/performance`]; 
        
        // Fonction asynchrone call api BackEnd fournit
        async function getUserDatas(){
            // Chargement Vrai
            setIsLoading(true);
            // Attente données recupérées par appel axios
            // fonctionnalité all permettant de faire plusieurs call api
            // map permettant de faire les 4 get d'un coup
            // fonctionnalité spread permettant de redistribuer les multiples call api
            // definition des 4 reponses(ex: responseUser, et changement nom data recupérée )
            // la variable data du 1er State devenant un objet avec les 4 types de données fournit par les endpoints
            await axios.all(endPoints.map(endPoint => axios.get(endPoint)))
                       .then(axios.spread((responseUser,responseActivity,responseAverage,responsePerform) => {
                           setData({
                               user: responseUser.data.data,
                               activity: responseActivity.data.data,
                               average: responseAverage.data.data,
                               perform: responsePerform.data.data
                            });
                           setIsLoading(false);
                       }))
                       .catch(err => {
                           console.log(err)
                           setError(true);
                       });
        }
        // Appel fonction getUserDatas
        getUserDatas();
    }, [path]);
    
    // retour des variables d'etat
    return { data, isLoading, error };
}               



   
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#App">App</a></li><li><a href="global.html#root">root</a></li><li><a href="global.html#useRequestDatas">useRequestDatas</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Tue May 10 2022 23:51:49 GMT+0200 (heure d’été d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
